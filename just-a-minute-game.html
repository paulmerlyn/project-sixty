<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Just-a-Minute</title>
    <style>
      /* Import professional Google Fonts */
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

      body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI',
          Roboto, sans-serif;
        text-align: center;
        background-color: #f8f9fa;
        margin: 0;
        padding: 24px;
        color: #333;
        line-height: 1.6;
      }

      .title-container {
        text-align: center;
        margin-bottom: 32px;
      }
      
      .main-title {
        font-family: 'Inter', sans-serif;
        font-size: 3rem;
        font-weight: 800;
        color: #2c3e50;
        margin-bottom: 8px;
        letter-spacing: -1px;
        background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 4px 20px rgba(52, 152, 219, 0.3), 0 2px 8px rgba(0, 0, 0, 0.2);
      }
      
      .subtitle {
        font-family: 'Inter', sans-serif;
        font-size: 1.5rem;
        font-weight: 400;
        color: #7f8c8d;
        margin: 0;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        border-bottom: 2px solid #3498db;
        padding-bottom: 8px;
        display: inline-block;
        text-shadow: 0 2px 10px rgba(52, 152, 219, 0.2);
      }

      #rules {
        position: relative;
        background-color: #fff;
        padding: 32px;
        margin: 24px auto;
        max-width: 700px;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        text-align: left;
        border: 1px solid #eaeaea;
      }

      .timer-controls-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px;
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
        border: 1px solid #eaeaea;
        margin-bottom: 24px;
      }
      
      .timer-buttons {
        display: flex;
        gap: 8px;
      }
      
      #timer-display {
        font-size: 48px;
        font-weight: 700;
        color: #3498db;
        background-color: rgba(255, 255, 255, 0.9);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(52, 152, 219, 0.2);
        border: 2px solid rgba(52, 152, 219, 0.1);
        font-family: 'Inter', sans-serif;
        margin-left: 16px;
        width: 120px;
        text-align: center;
      }

      #rules h2 {
        color: #2c3e50;
        margin-top: 0;
        font-size: 1.75rem;
        font-weight: 600;
        margin-bottom: 16px;
        border-bottom: 2px solid #3498db;
        padding-bottom: 8px;
        display: inline-block;
      }

      #rules ul {
        padding-left: 32px;
        color: #555;
        list-style-type: none;
        margin: 8px 0;
      }
      
      #rules ul li::before {
        content: "•";
        color: #3498db;
        font-weight: bold;
        display: inline-block;
        width: 1em;
        margin-left: -1em;
        font-size: 1.2em;
      }

      #rules li {
        margin-bottom: 4px;
        line-height: 1.4;
      }

      #rules h3 {
        color: #2c3e50;
        margin-top: 16px;
        margin-bottom: 8px;
        font-size: 1.1rem;
        font-weight: 500;
      }

      #rules ol {
        padding-left: 32px;
        color: #555;
        margin: 8px 0;
      }

      #rules ol li {
        margin-bottom: 4px;
        line-height: 1.4;
      }

      button {
        padding: 14px 28px;
        font-size: 1rem;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 16px;
        font-family: 'Inter', sans-serif;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(52, 152, 219, 0.2);
      }

      button:hover {
        background-color: #2980b9;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
      }

      button:active {
        transform: translateY(0);
      }

      #topicDisplay {
        margin-top: 32px;
        font-size: 2rem;
        font-weight: 700;
        color: #2c3e50;
        min-height: 56px;
        padding: 16px;
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
        border: 2px solid #eaeaea;
        font-family: 'Inter', sans-serif;
        transition: all 0.3s ease;
        border-left: 4px solid #3498db;
      }

      details {
        margin: 20px auto;
        max-width: 700px;
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
        padding: 32px;
        border: 1px solid #eaeaea;
        transition: all 0.3s ease;
        font-family: 'Inter', sans-serif;
      }
      
      details[open] {
        border-color: #3498db;
      }

      details[open] {
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12);
      }

      .inner-details {
        background-color: transparent;
        box-shadow: none;
        padding: 0;
        margin: 12px 0;
      }
      
      .inner-details summary {
        margin-left: 0;
        margin-right: 0;
      }
      
      .inner-details p {
        padding: 8px 12px;
        text-align: left;
        margin: 6px 0;
        line-height: 1.8;
      }
      
      .inner-details ol {
        padding: 8px 12px;
        margin: 6px 0;
      }
      
      .scoring-details ol {
        margin-left: 16px;
        margin-top: 6px;
        margin-bottom: 6px;
      }

      summary {
        cursor: pointer;
        font-weight: 600;
        color: #2c3e50;
        font-size: 1.1rem;
        padding: 12px 16px;
        border-radius: 8px;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-family: 'Inter', sans-serif;
        position: relative;
      }

      summary:hover {
        background-color: #f8f9fa;
        color: #3498db;
      }

      summary::after {
        content: '▼';
        font-size: 0.8rem;
        transition: transform 0.3s ease;
        color: #3498db;
      }

      details[open] summary::after {
        transform: rotate(180deg);
      }

      summary::before {
        content: '';
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        width: 3px;
        height: 24px;
        background-color: #3498db;
        border-radius: 2px;
      }

      form {
        margin-top: 16px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        color: #2c3e50;
        font-weight: 500;
        font-family: 'Inter', sans-serif;
      }

      textarea {
        width: 100%;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-family: 'Inter', sans-serif;
        box-sizing: border-box;
        transition: border-color 0.3s ease;
        font-size: 1rem;
      }

      textarea:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.1);
      }

      #contestantManager {
        display: flex;
        gap: 12px;
        margin-bottom: 16px;
        align-items: center;
      }

      #newContestant {
        flex: 1;
        height: 40px;
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-family: 'Inter', sans-serif;
        box-sizing: border-box;
        transition: border-color 0.3s ease;
        font-size: 1rem;
        line-height: 24px;
        vertical-align: middle;
      }

      #newContestant:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.1);
      }

      #addContestant {
        height: 40px;
        width: 40px;
        font-size: 1.2rem;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        box-sizing: border-box;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        vertical-align: middle;
        margin-top: -2px;
      }

      #addContestant:hover {
        background-color: #2980b9;
        transform: scale(1.05);
      }

      .contestant-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #eee;
        transition: background-color 0.2s ease;
      }

      .contestant-item:hover {
        background-color: #f8f9fa;
      }

      .remove-btn {
        background-color: #e74c3c;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        padding: 6px 12px;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        font-family: 'Inter', sans-serif;
        font-weight: 500;
      }

      .remove-btn:hover {
        background-color: #c0392b;
        transform: scale(1.05);
      }
      
      .remove-btn:active {
        background-color: #a02e22;
        transform: scale(0.9);
      }
      
      .remove-btn.removed {
        animation: removedPulse 0.4s ease;
      }

      .scoreboard-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 14px 0;
        border-bottom: 1px solid #eee;
        transition: background-color 0.2s ease;
      }

      .scoreboard-item:hover {
        background-color: #f8f9fa;
      }

      .plus-btn,
      .minus-btn {
        padding: 6px 12px;
        font-size: 0.9rem;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        margin-left: 4px;
        transition: all 0.3s ease;
        font-family: 'Inter', sans-serif;
        font-weight: 500;
        position: relative;
        bottom: 6px;
      }

      .plus-btn {
        background-color: #2ecc71;
        color: white;
      }

      .plus-btn:hover {
        background-color: #27ae60;
        transform: scale(1.05);
      }

      .minus-btn {
        background-color: #e74c3c;
        color: white;
      }

      .minus-btn:hover {
        background-color: #c0392b;
        transform: scale(1.05);
      }

      .score {
        font-size: 1.5rem;
        font-weight: 700;
        color: #3498db;
        margin: 0 16px;
        font-family: 'Inter', sans-serif;
        flex: 0 0 60px;
        text-align: center;
      }

      .player-name {
        width: 150px;
        display: inline-block;
        font-weight: 500;
        color: #2c3e50;
        font-family: 'Inter', sans-serif;
        text-align: left;
        flex: 1;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 12px;
        font-size: 0.95rem;
        font-family: 'Inter', sans-serif;
      }

      th,
      td {
        padding: 10px 12px;
        text-align: left;
        border-bottom: 1px solid #eee;
      }

      th {
        background-color: #f8f9fa;
        font-weight: 600;
        color: #2c3e50;
        padding: 12px 12px;
      }

      tr:hover {
        background-color: #f1f5f9;
      }

      .remove-topic-btn {
        background-color: #e74c3c;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        padding: 6px 12px;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        font-family: 'Inter', sans-serif;
        font-weight: 500;
      }

      .remove-topic-btn:hover {
        background-color: #c0392b;
        transform: scale(1.05);
      }
      
      .remove-topic-btn:active {
        background-color: #a02e22;
        transform: scale(0.9);
      }
      
      /* Animation for remove button */
      @keyframes removedPulse {
        0% { transform: scale(1); background-color: #e74c3c; box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.4); }
        30% { transform: scale(1.15); background-color: #c0392b; box-shadow: 0 0 0 8px rgba(231, 76, 60, 0.2); }
        70% { transform: scale(0.95); background-color: #a02e22; box-shadow: 0 0 0 12px rgba(231, 76, 60, 0.1); }
        100% { transform: scale(1); background-color: #e74c3c; box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
      }
      
      .remove-topic-btn.removed {
        animation: removedPulse 0.4s ease;
      }
      
      /* Animation for add buttons (blue +) */
      @keyframes addedPulse {
        0% { transform: scale(1); background-color: #3498db; box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.4); }
        30% { transform: scale(1.15); background-color: #2980b9; box-shadow: 0 0 0 8px rgba(52, 152, 219, 0.2); }
        70% { transform: scale(0.95); background-color: #1f6fb2; box-shadow: 0 0 0 12px rgba(52, 152, 219, 0.1); }
        100% { transform: scale(1); background-color: #3498db; box-shadow: 0 0 0 0 rgba(52, 152, 219, 0); }
      }
      
      #addContestant:active, #addTopicBtn:active {
        transform: scale(0.9);
      }
      
      #addContestant.added, #addTopicBtn.added {
        animation: addedPulse 0.4s ease;
      }
      
      /* Animation for score buttons - more pronounced */
      @keyframes plusScorePulse {
        0% { transform: scale(1); background-color: #2ecc71; box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.5); }
        30% { transform: scale(1.3); background-color: #27ae60; box-shadow: 0 0 0 12px rgba(46, 204, 113, 0.3); }
        70% { transform: scale(0.9); background-color: #239b56; box-shadow: 0 0 0 16px rgba(46, 204, 113, 0.2); }
        100% { transform: scale(1); background-color: #2ecc71; box-shadow: 0 0 0 0 rgba(46, 204, 113, 0); }
      }
      
      @keyframes minusScorePulse {
        0% { transform: scale(1); background-color: #e74c3c; box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.5); }
        30% { transform: scale(1.3); background-color: #c0392b; box-shadow: 0 0 0 12px rgba(231, 76, 60, 0.3); }
        70% { transform: scale(0.9); background-color: #a02e22; box-shadow: 0 0 0 16px rgba(231, 76, 60, 0.2); }
        100% { transform: scale(1); background-color: #e74c3c; box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
      }
      
      .plus-btn:active, .minus-btn:active {
        transform: scale(0.85);
      }
      
      .plus-btn.scored {
        animation: plusScorePulse 0.5s ease;
      }
      
      .minus-btn.scored {
        animation: minusScorePulse 0.5s ease;
      }
      
      /* Animation for generate button */
      @keyframes generatePulse {
        0% { transform: scale(1); background-color: #2ecc71; box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.4); }
        30% { transform: scale(1.08); background-color: #27ae60; box-shadow: 0 0 0 10px rgba(46, 204, 113, 0.2); }
        70% { transform: scale(0.98); background-color: #239b56; box-shadow: 0 0 0 12px rgba(46, 204, 113, 0.1); }
        100% { transform: scale(1); background-color: #2ecc71; box-shadow: 0 0 0 0 rgba(46, 204, 113, 0); }
      }
      
      #generateBtn:active {
        transform: scale(0.95);
      }
      
      #generateBtn.generated {
        animation: generatePulse 0.5s ease;
      }
      
      /* Animation for timer buttons */
      @keyframes timerPulse {
        0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.3); }
        30% { transform: scale(1.08); box-shadow: 0 0 0 6px rgba(52, 152, 219, 0.15); }
        70% { transform: scale(0.98); box-shadow: 0 0 0 8px rgba(52, 152, 219, 0.1); }
        100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(52, 152, 219, 0); }
      }
      
      button:active {
        transform: scale(0.95);
      }
      
      button.timer-action {
        animation: timerPulse 0.3s ease;
      }
      
      .select-topic-btn:hover {
        background-color: #27ae60;
        transform: scale(1.05);
      }
      
      /* Click animation for select button */
      .select-topic-btn:active {
        background-color: #1e8449;
        transform: scale(0.9);
      }
      
      /* Animation for when topic is selected - more pronounced */
      @keyframes selectedPulse {
        0% { transform: scale(1); background-color: #2ecc71; box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.4); }
        30% { transform: scale(1.2); background-color: #239b56; box-shadow: 0 0 0 10px rgba(46, 204, 113, 0.2); }
        70% { transform: scale(0.95); background-color: #1e8449; box-shadow: 0 0 0 15px rgba(46, 204, 113, 0.1); }
        100% { transform: scale(1); background-color: #2ecc71; box-shadow: 0 0 0 0 rgba(46, 204, 113, 0); }
      }
      
      .select-topic-btn.selected {
        animation: selectedPulse 0.5s ease;
      }
      
      /* Custom tooltip for faster appearance */
      .select-topic-btn, .remove-topic-btn, .remove-btn, #addContestant, #addTopicBtn, #generateBtn {
        position: relative;
      }
      
      .select-topic-btn::after {
        content: 'Set this topic';
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background-color: #333;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.1s ease;
        margin-bottom: 5px;
        z-index: 100;
      }
      
      .remove-topic-btn::after {
        content: 'Remove topic';
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background-color: #333;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.1s ease;
        margin-bottom: 5px;
        z-index: 100;
      }
      
      .remove-btn::after {
        content: 'Remove player';
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background-color: #333;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.1s ease;
        margin-bottom: 5px;
        z-index: 100;
      }
      
      .select-topic-btn:hover::after,
      .remove-topic-btn:hover::after,
      .remove-btn:hover::after {
        opacity: 1;
      }
      
      #addTopicBtn::after {
        content: 'Add topic';
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background-color: #333;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.1s ease;
        margin-bottom: 5px;
        z-index: 100;
      }
      
      #addContestant::after {
        content: 'Add player';
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background-color: #333;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.1s ease;
        margin-bottom: 5px;
        z-index: 100;
      }
      
      #generateBtn::after {
        content: 'Generate (or pick from Topics Manager)';
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background-color: #333;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.1s ease;
        margin-bottom: 5px;
        z-index: 100;
        max-width: 300px;
        text-align: center;
      }
      
      #addTopicBtn:hover::after,
      #addContestant:hover::after,
      #generateBtn:hover::after {
        opacity: 1;
      }
    </style>
  </head>
  <body>
    <div class="title-container">
      <h1 class="main-title">Just-a-Minute</h1>
      <p class="subtitle">Family & Friends Edition</p>
    </div>
    <div id="rules">
      <details class="inner-details" style="border: 1px solid #eaeaea;">
        <summary>Gameplay</summary>
        <p style="line-height: 1.8;">Generate (or select) a topic. Start the timer. The player must speak for one minute without:</p>
        <ul>
          <li>hesitation</li>
          <li>deviation</li>
          <li>repetition</li>
        </ul>
        <p style="line-height: 1.8;">Stop the clock when another player challenges the speaker.</p>
        <p style="line-height: 1.8;">For a correct challenge of hesitation, deviation, or repetition, the challenger continues the topic with the time remaining.</p>
        <p style="line-height: 1.8;">For an incorrect challenge, the speaker resumes.</p>
        <p style="line-height: 1.8;">When the minute is up, rotate to the next player.</p>
      </details>
      <details class="inner-details" style="border: 1px solid #eaeaea;">
        <summary>Finer Points</summary>
        <p style="text-align: left; line-height: 1.8;">
          <strong><em>Hesitation</em></strong> means noticeable ums, pauses, lip-smacks, etc.<br>
          <strong><em>Deviation</em></strong> means straying off topic (though brief tangents are allowable if the speaker returns to the topic).<br>
          <strong><em>Repetition</em></strong> means excessive reuse of a word. Exceptions: words in the topic and common link words such as "and", "a", and "the" are allowable.<br>
          <strong><em>Plural</em></strong> forms (e.g. cat and cats) and <strong><em>derivatives</em></strong> (e.g. bake, baking, and baked) are distinct words and may each be used once.<br>
        </p>
      </details>
      
      <details class="inner-details scoring-details" style="border: 1px solid #eaeaea;">
        <summary>Scoring</summary>
        <ol>
          <li>One point for the player speaking at the one-minute mark</li>
          <li>One point to the challenger for a correct challenge</li>
          <li>One point to the speaker for an incorrect challenge</li>
          <li>One bonus point to a speaker who completes an entire minute</li>
        </ol>
      </details>
      <div id="timer">
        <div class="timer-controls-container">
          <div class="timer-buttons">
            <button onclick="startTimer()">Start</button>
            <button onclick="stopTimer()">Stop</button>
            <button onclick="resetTimer()">Reset</button>
            <button onclick="add5()">+5</button>
            <button onclick="sub5()">-5</button>
          </div>
          <div id="timer-display">60</div>
        </div>
      </div>
      <div
        style="
          margin-top: 24px;
          padding-top: 24px;
          border-top: 1px solid #eaeaea;
        "
      >
        <button
          id="generateBtn"
          style="background-color: #2ecc71; margin-bottom: 16px"
        >
          Generate Topic
        </button>
        <div id="topicDisplay"></div>
        <a id="topicAnchor" style="display: block; position: relative; top: -100px; visibility: hidden;"></a>
      </div>
    </div>
    <details style="border: 1px solid #eaeaea;">
      <summary>Manage Players</summary>
      <div id="contestantManager">
        <div style="margin-bottom: 15px; padding: 10px; background-color: #f9f9f9; border-radius: 5px; display: flex; gap: 12px; align-items: center;">
          <input type="text" id="newContestant" placeholder="Enter player name" />
          <button id="addContestant">+</button>
        </div>
      </div>
      <div id="contestantList"></div>
    </details>
    <details style="border: 1px solid #eaeaea;">
      <summary>Scoreboard</summary>
      <div id="scoreboard"></div>
    </details>
    <details style="border: 1px solid #eaeaea;">
      <summary>Topics Manager</summary>
      <div id="topicsManager"></div>
    </details>

    <script>
      // Topic management system with persistent deletions
      const ALL_TOPICS = [
        'Garden gnomes',
        'A good book',
        'The Wizard of Oz',
        'Is golf a good walk spoiled?',
        'Grandparents',
        'Good taste in music',
        'Not worth the money',
        'Cats and dogs',
        'Public or private?',
        'Unicorns, gryphons, and dragons',
        'The tooth fairy',
        'First-class travel',
        'Social media',
        'Should adults be allowed to access social media?',
        'Childhood best friends',
        'Nosy neighbors',
        'Small talk',
        'Space tourism',
        'Talking to pets',
        'Robot assistants',
        'Self-driving cars',
        'Virtual reality dating',
        'The 4-day work week',
        'Tipping culture',
        'The middle seat',
        'Re-gifting',
        'Wedding speeches',
        'Poetry',
        "New Year's resolutions",
        'Museums',
        'Social media influencers',
        'Retro fashion',
        'Meditation',
        'Tea or coffee?',
        'Window seats',
        'Camping or glamping?',
        'Early bird or night owl?',
        'Board games',
        'Renewable energy',
        'Food trucks',
        'Farmers markets',
        'Recycling',
        'Awkward silences',
        'First impressions',
        'High school drama',
        'Bad haircuts',
        'Lottery winners',
        'Invisibility',
        'Flying cars',
        'Strict librarians',
        'Hoarding',
        'Feng shui',
        'Interior design',
        'Tiny houses',
        'Treehouses',
        'Castles',
        'Luxury cruises',
        'The stock market',
        'Disney',
        'Roller coasters',
        'Skiing',
        'Dance',
        'Road trips',
        'People with whom I might disagree',
        'Wine tasting',
        'Buffets',
        'Fine dining',
        'Fast food',
        'Bridge',
        'Scrabble',
        'People who clap when the plane lands',
        'Bad jokes',
        'Church and state',
        'Fruit and vegetables',
        'The good old days',
        'If I were in charge of everything...',
        'DIY',
      ];

      // Load deleted topics from localStorage
      let deletedTopics = [];
      const savedDeletedTopics = localStorage.getItem('deletedTopics');
      if (savedDeletedTopics) {
        try {
          deletedTopics = JSON.parse(savedDeletedTopics);
          if (!Array.isArray(deletedTopics)) {
            deletedTopics = [];
          }
        } catch (e) {
          deletedTopics = [];
        }
      }

      // Filter out deleted topics from the main list
      let topics = ALL_TOPICS.filter((topic) => !deletedTopics.includes(topic));

      // Load any custom topics from localStorage
      const savedTopics = localStorage.getItem('topics');
      if (savedTopics) {
        try {
          const customTopics = JSON.parse(savedTopics);
          if (Array.isArray(customTopics)) {
            // Add custom topics that aren't in the deleted list
            topics = topics.concat(
              customTopics.filter((topic) => !deletedTopics.includes(topic))
            );
          }
        } catch (e) {
          // Ignore corrupted data
        }
      }
      function renderTopics() {
        const topicsManager = document.getElementById('topicsManager');
        const formHTML =
          '<div style="margin-bottom: 15px; padding: 10px; background-color: #f9f9f9; border-radius: 5px; display: flex; gap: 12px; align-items: center;">' +
          '<input type="text" id="newTopic" placeholder="Enter new topic" style="flex: 1; height: 40px; padding: 8px 12px; border: 1px solid #ddd; border-radius: 8px; font-family: \'Inter\', sans-serif; box-sizing: border-box; transition: border-color 0.3s ease; font-size: 1rem; line-height: 24px; vertical-align: middle;">' +
          '<button id="addTopicBtn" style="height: 40px; width: 40px; font-size: 1.2rem; background-color: #3498db; color: white; border: none; border-radius: 8px; cursor: pointer; box-sizing: border-box; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; flex-shrink: 0; vertical-align: middle; margin-top: -2px;">+</button>' +
          '</div>';

        // Remove duplicates while preserving order
        const uniqueTopics = [];
        const seenTopics = new Set();
        topics.forEach((topic) => {
          if (!seenTopics.has(topic)) {
            seenTopics.add(topic);
            uniqueTopics.push(topic);
          }
        });

        // Sort topics alphabetically
        uniqueTopics.sort((a, b) => a.localeCompare(b));

        if (uniqueTopics.length === 0) {
          topicsManager.innerHTML = formHTML + '<p>No topics available</p>';
          return;
        }

        let tableHTML =
          formHTML +
          '<table style="width: 100%; border-collapse: collapse; margin-top: 10px;">';
        tableHTML +=
          '<thead><tr><th style="text-align: left; padding: 8px; border-bottom: 1px solid #ddd;">Topic</th><th style="text-align: right; padding: 8px; border-bottom: 1px solid #ddd;">Action</th></tr></thead>';
        tableHTML += '<tbody>';

        uniqueTopics.forEach((topic, index) => {
          tableHTML += `<tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 8px;">${topic}</td>
                    <td style="padding: 8px; text-align: right;">
                        <button class="select-topic-btn" data-topic="${topic}" style="background-color: #2ecc71; color: white; border: none; border-radius: 3px; cursor: pointer; padding: 5px 10px; font-size: 14px; margin-right: 5px;">✓</button>
                        <button class="remove-topic-btn" data-topic="${topic}" style="background-color: #f44336; color: white; border: none; border-radius: 3px; cursor: pointer; padding: 5px 10px; font-size: 14px;">–</button>
                    </td>
                </tr>`;
        });

        tableHTML += '</tbody></table>';
        topicsManager.innerHTML = tableHTML;
      }

      let timeLeft = 60.0;
      let timerId = null;
      let isRunning = false;
      const timerDisplay = document.getElementById('timer-display');

      function updateDisplay() {
        const timerDisplayCentered = document.getElementById('timer-display');
        if (timerDisplayCentered) timerDisplayCentered.textContent = timeLeft.toFixed(1);
      }

      function startTimer() {
        if (!isRunning && timeLeft > 0) {
          isRunning = true;
          timerId = setInterval(() => {
            timeLeft = Math.max(0, timeLeft - 0.1);
            updateDisplay();
            if (timeLeft <= 0) {
              clearInterval(timerId);
              isRunning = false;
              timeLeft = 0;
              updateDisplay();
              playCelebratorySound();
            }
          }, 100);
          
          // Add visual feedback to the Start button
          const startBtn = document.querySelector('button[onclick="startTimer()"]');
          if (startBtn) {
            startBtn.classList.add('timer-action');
            setTimeout(() => {
              startBtn.classList.remove('timer-action');
            }, 300);
          }
        }
      }

      function playCelebratorySound() {
        const audioContext = new (window.AudioContext ||
          window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        const filter = audioContext.createBiquadFilter();

        oscillator.connect(filter);
        filter.connect(gainNode);
        gainNode.connect(audioContext.destination);

        // Create an uplifting, celebratory sound
        oscillator.type = 'sine';
        oscillator.frequency.value = 1500;

        // Set up filter for brighter quality
        filter.type = 'highpass';
        filter.frequency.value = 2000;
        filter.Q.value = 3;

        gainNode.gain.value = 0.01; // Start quietly

        oscillator.start();

        // Create celebratory rising effect with multiple frequency jumps
        oscillator.frequency.exponentialRampToValueAtTime(
          2500,
          audioContext.currentTime + 0.3
        );
        oscillator.frequency.exponentialRampToValueAtTime(
          3500,
          audioContext.currentTime + 0.9
        );
        oscillator.frequency.exponentialRampToValueAtTime(
          4500,
          audioContext.currentTime + 1.5
        );

        // Volume envelope with crescendo effect
        gainNode.gain.exponentialRampToValueAtTime(
          0.15,
          audioContext.currentTime + 0.2
        );
        gainNode.gain.exponentialRampToValueAtTime(
          0.25,
          audioContext.currentTime + 0.8
        );
        gainNode.gain.exponentialRampToValueAtTime(
          0.1,
          audioContext.currentTime + 1.5
        );
        gainNode.gain.exponentialRampToValueAtTime(
          0.0001,
          audioContext.currentTime + 1.8
        );

        oscillator.stop(audioContext.currentTime + 1.8);
      }

      function stopTimer() {
        clearInterval(timerId);
        isRunning = false;
        
        // Add visual feedback to the Stop button
        const stopBtn = document.querySelector('button[onclick="stopTimer()"]');
        if (stopBtn) {
          stopBtn.classList.add('timer-action');
          setTimeout(() => {
            stopBtn.classList.remove('timer-action');
          }, 300);
        }
      }

      function resumeTimer() {
        if (!isRunning && timeLeft > 0) {
          isRunning = true;
          timerId = setInterval(() => {
            timeLeft -= 0.1;
            updateDisplay();
            if (timeLeft <= 0) {
              clearInterval(timerId);
              isRunning = false;
            }
          }, 100);
        }
      }

      function resetTimer() {
        timeLeft = 60.0;
        updateDisplay();
        clearInterval(timerId);
        isRunning = false;
        
        // Add visual feedback to the Reset button
        const resetBtn = document.querySelector('button[onclick="resetTimer()"]');
        if (resetBtn) {
          resetBtn.classList.add('timer-action');
          setTimeout(() => {
            resetBtn.classList.remove('timer-action');
          }, 300);
        }
      }

      function add5() {
        timeLeft = Math.min(60, timeLeft + 5);
        updateDisplay();
        
        // Add visual feedback to the +5 button
        const add5Btn = document.querySelector('button[onclick="add5()"]');
        if (add5Btn) {
          add5Btn.classList.add('timer-action');
          setTimeout(() => {
            add5Btn.classList.remove('timer-action');
          }, 300);
        }
      }

      function sub5() {
        timeLeft = Math.max(0, timeLeft - 5);
        updateDisplay();
        
        // Add visual feedback to the -5 button
        const sub5Btn = document.querySelector('button[onclick="sub5()"]');
        if (sub5Btn) {
          sub5Btn.classList.add('timer-action');
          setTimeout(() => {
            sub5Btn.classList.remove('timer-action');
          }, 300);
        }
      }

      const generateBtn = document.getElementById('generateBtn');
      const topicDisplay = document.getElementById('topicDisplay');
      let players = [];
      const stored = localStorage.getItem('players');
      if (stored) {
        try {
          players = JSON.parse(stored);
          if (!Array.isArray(players)) {
            players = [];
          } else if (players.length > 0 && typeof players[0] === 'string') {
            players = players.map((name) => ({ name, score: 0 }));
          }
        } catch (e) {
          players = [];
        }
      }
      const addContestantBtn = document.getElementById('addContestant');
      const newContestantInput = document.getElementById('newContestant');
      const contestantList = document.getElementById('contestantList');
      const scoreboard = document.getElementById('scoreboard');

      function renderContestants() {
        contestantList.innerHTML = '';
        if (players.length === 0) {
          contestantList.innerHTML = '<p>No players added yet</p>';
          return;
        }
        let tableHTML = '<table style="width: 100%; border-collapse: collapse; margin-top: 12px; font-size: 0.95rem; font-family: \'Inter\', sans-serif;">';
        tableHTML += '<thead><tr><th style="text-align: left; padding: 8px; border-bottom: 1px solid #ddd;">Player</th><th style="text-align: right; padding: 8px; border-bottom: 1px solid #ddd;">Action</th></tr></thead>';
        tableHTML += '<tbody>';
        players.forEach((player, index) => {
          tableHTML += `<tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 8px;">${player.name}</td>
                        <td style="padding: 8px; text-align: right;"><button class="remove-btn" data-index="${index}">–</button></td>
                    </tr>`;
        });
        tableHTML += '</tbody></table>';
        contestantList.innerHTML = tableHTML;
        localStorage.setItem('players', JSON.stringify(players));
      }

      function renderScoreboard() {
        scoreboard.innerHTML = '';
        players.forEach((player, index) => {
          const div = document.createElement('div');
          div.className = 'scoreboard-item';
          div.innerHTML = `<span class="player-name">${player.name}</span> <span class="score">${player.score}</span> <div style="display: flex; gap: 4px; align-items: center;"><button class="plus-btn" data-index="${index}">+1</button> <button class="minus-btn" data-index="${index}">-1</button></div>`;
          scoreboard.appendChild(div);
        });
      }

      generateBtn.addEventListener('click', () => {
        const randomIndex = Math.floor(Math.random() * topics.length);
        topicDisplay.textContent = topics[randomIndex];
        
        // Add visual feedback
        generateBtn.classList.add('generated');
        setTimeout(() => {
          generateBtn.classList.remove('generated');
        }, 500);
      });

      addContestantBtn.addEventListener('click', () => {
        const name = newContestantInput.value.trim();
        if (name) {
          players.push({ name: name, score: 0 });
          newContestantInput.value = '';
          
          // Add visual feedback
          addContestantBtn.classList.add('added');
          setTimeout(() => {
            addContestantBtn.classList.remove('added');
          }, 400);
          
          renderContestants();
          renderScoreboard();
        }
      });

      newContestantInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          addContestantBtn.click();
        }
      });

      contestantList.addEventListener('click', (e) => {
        if (e.target.classList.contains('remove-btn')) {
          const index = parseInt(e.target.dataset.index);
          const button = e.target;
          
          // Add visual feedback - pulse animation
          button.classList.add('removed');
          
          // Remove player after animation
          setTimeout(() => {
            players.splice(index, 1);
            renderContestants();
            renderScoreboard();
          }, 400);
        }
      });

      scoreboard.addEventListener('click', (e) => {
        const index = parseInt(e.target.dataset.index);
        const button = e.target;
        
        if (e.target.classList.contains('plus-btn')) {
          players[index].score++;
          
          // Add visual feedback
          button.classList.add('scored');
          setTimeout(() => {
            button.classList.remove('scored');
          }, 300);
          
          renderScoreboard();
          localStorage.setItem('players', JSON.stringify(players));
        } else if (e.target.classList.contains('minus-btn')) {
          players[index].score--;
          
          // Add visual feedback
          button.classList.add('scored');
          setTimeout(() => {
            button.classList.remove('scored');
          }, 300);
          
          renderScoreboard();
          localStorage.setItem('players', JSON.stringify(players));
        }
      });

      renderContestants();
      renderScoreboard();
      renderTopics();

      // Add event listener for topic management (add, remove, and select)
      document
        .getElementById('topicsManager')
        .addEventListener('click', (e) => {
          if (e.target.classList.contains('remove-topic-btn')) {
            const topicToDelete = e.target.dataset.topic;
            const button = e.target;

            // Add visual feedback - pulse animation
            button.classList.add('removed');
            
            // Remove from current topics and re-render after animation
            setTimeout(() => {
              // Add to deleted topics list
              if (!deletedTopics.includes(topicToDelete)) {
                deletedTopics.push(topicToDelete);
                localStorage.setItem(
                  'deletedTopics',
                  JSON.stringify(deletedTopics)
                );
              }

              // Remove from current topics and re-render
              const index = topics.indexOf(topicToDelete);
              if (index !== -1) {
                topics.splice(index, 1);
              }
              renderTopics();
              localStorage.setItem('topics', JSON.stringify(topics));
            }, 400);
          } else if (e.target.classList.contains('select-topic-btn')) {
            const selectedTopic = e.target.dataset.topic;
            topicDisplay.textContent = selectedTopic;
            
            // Add visual feedback - pulse animation
            e.target.classList.add('selected');
            
            // Scroll to center the topic display panel in the viewport
            setTimeout(() => {
              const anchor = document.getElementById('topicAnchor');
              if (anchor) {
                const anchorPosition = anchor.getBoundingClientRect().top + window.scrollY;
                const viewportHeight = window.innerHeight;
                const targetPosition = anchorPosition - (viewportHeight / 2) + 100; // Center with offset
                
                window.scrollTo({
                  top: targetPosition,
                  behavior: 'smooth'
                });
              }
            }, 100);
            
            // Remove the class after animation completes
            setTimeout(() => {
              e.target.classList.remove('selected');
            }, 500);
          } else if (e.target.id === 'addTopicBtn') {
            addNewTopic();
            
            // Add visual feedback
            const addTopicBtn = document.getElementById('addTopicBtn');
            addTopicBtn.classList.add('added');
            setTimeout(() => {
              addTopicBtn.classList.remove('added');
            }, 400);
          }
        });

      // Add event listener for Enter key in new topic input
      document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('newTopic').addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            addNewTopic();
          }
        });
      });

      function addNewTopic() {
        const newTopicInput = document.getElementById('newTopic');
        const topicName = newTopicInput.value.trim();

        if (topicName) {
          topics.push(topicName);
          newTopicInput.value = '';
          renderTopics();
          localStorage.setItem('topics', JSON.stringify(topics));
        }
      }
    </script>
  </body>
</html>
